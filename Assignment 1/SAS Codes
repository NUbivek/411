
libname HW'/home/bivek0/my_courses/donald.wedding/c_8888/PRED411/UNIT01/HW' access=readonly;

proc contents data=hw.moneyball; run; quit;

/**proc print data=mydata.ames_housing_data; run; quit;
**/

proc print data=hw.moneyball (obs=10); run; quit;

proc MEANS data=hw.moneyball MEAN MEDIAN MODE N NMISS STDDEV VARDEF=DF CLM;
run;

proc means data=hw.moneyball p1 p99;

*PROC UNIVARIATE to examine distributions and outliers; PROC UNIVARIATE NORMAL PLOT DATA=hw.moneyball; VAR TEAM_BATTING_H
TEAM_BATTING_2B TEAM_BATTING_3B TEAM_BATTING_HR TEAM_BATTING_BB TEAM_BATTING_SO TEAM_BASERUN_SB TEAM_BASERUN_CS TEAM_PITCHING_H TEAM_PITCHING_HR TEAM_PITCHING_BB TEAM_PITCHING_SO TEAM_FIELDING_E
; RUN;
*PROC reg without 2 variables, and with only 14 variables; proc reg data =hw.moneyball;
model TARGET_WINS = TEAM_BATTING_H TEAM_BATTING_2B TEAM_BATTING_3B TEAM_BATTING_HR
 
TEAM_BATTING_BB TEAM_BATTING_SO TEAM_BASERUN_SB TEAM_BASERUN_CS TEAM_PITCHING_H TEAM_PITCHING_HR TEAM_PITCHING_BB TEAM_PITCHING_SO TEAM_FIELDING_E
/TOL VIF COLLIN;
run; quit;
*Step-wise selection method; proc reg data =hw.moneyball; model Target_Wins = TEAM_BATTING_H TEAM_BATTING_2B TEAM_BATTING_3B TEAM_BATTING_HR TEAM_BATTING_BB TEAM_BATTING_SO TEAM_BASERUN_SB TEAM_BASERUN_CS TEAM_PITCHING_H TEAM_PITCHING_HR TEAM_PITCHING_BB TEAM_PITCHING_SO TEAM_FIELDING_E
/selection=stepwise; run;

data TEMPFILE1;
set hw.moneyball;
drop TEAM_BASERUN_CS; run;
*Run regression for TEMPFILE1; proc reg data =TEMPFILE1; model TARGET_WINS = TEAM_BATTING_H TEAM_BATTING_2B TEAM_BATTING_3B TEAM_BATTING_HR TEAM_BATTING_BB TEAM_BATTING_SO TEAM_BASERUN_SB
 
TEAM_PITCHING_H TEAM_PITCHING_HR TEAM_PITCHING_BB TEAM_PITCHING_SO TEAM_FIELDING_E
/TOL VIF COLLIN;
run; quit;

*assigning value to missing variables;

*Generate descriptives;
proc MEANS data=TEMPFILE1 MEAN MEDIAN MODE N NMISS STDDEV VARDEF=DF CLM;
run;

*Impute median values and run univariate descriptive, check PROC MEANS, and include "missing" flags (M);
data TEMPFILE1; set TEMPFILE2;

M_TEAM_BASERUN_SB = 0;
if missing(TEAM_BASERUN_SB) then do; M_TEAM_BASERUN_SB = 1;
TEAM_BASERUN_SB = 101;
end; M_TEAM_BATTING_SO = 0;
if missing(TEAM_BATTING_SO) then do; M_TEAM_BATTING_SO = 1;
TEAM_BATTING_SO = 750;
end; M_TEAM_PITCHING_SO = 0;
if missing(TEAM_PITCHING_SO) then do; M_TEAM_PITCHING_SO = 1;
TEAM_PITCHING_SO = 814;
end; run;
proc means data=TEMPFILE2 MEAN MEDIAN MODE N NMISS STDDEV VARDEF=DF CLM;

proc reg data =TEMPFILE2; model TARGET_WINS = TEAM_BATTING_H TEAM_BATTING_3B TEAM_BATTING_HR
 
TEAM_BATTING_BB TEAM_BATTING_SO TEAM_BASERUN_SB TEAM_PITCHING_H TEAM_PITCHING_HR TEAM_PITCHING_BB TEAM_PITCHING_SO TEAM_FIELDING_E
/TOL VIF COLLIN;
run; quit;

/**
proc print data=hw.moneyball_test(obs=3); run;
**/

data SCOREFILE;
set hw.moneyball_test;

drop TEAM_BASERUN_CS; drop TEAM_BATTING_HBP; drop TEAM_FIELDING_DP;

M_TEAM_BASERUN_SB = 0;
if missing(TEAM_BASERUN_SB) then do; M_TEAM_BASERUN_SB = 1;
TEAM_BASERUN_SB = 101;
end; M_TEAM_BATTING_SO = 0;
if missing(TEAM_BATTING_SO) then do; M_TEAM_BATTING_SO = 1;
TEAM_BATTING_SO = 750;
end; M_TEAM_PITCHING_SO = 0;
if missing(TEAM_PITCHING_SO) then do; M_TEAM_PITCHING_SO = 1;
TEAM_PITCHING_SO = 814;
end;

P_TARGET_WINS= 12.85469
+ 0.04205 * TEAM_BATTING_H
+ 0.07591 * TEAM_BATTING_3B
+ 0.03605 * TEAM_BATTING_HR
+ 0.00398 * TEAM_BATTING_BB
 
+ -0.00632* TEAM_BATTING_SO
+ 0.03185 * TEAM_BASERUN_SB
+ -0.00084374 * TEAM_PITCHING_H
+ 0.01273 * TEAM_PITCHING_HR
+ 0.00012757 * TEAM_PITCHING_BB
+ 0.00245 * TEAM_PITCHING_SO
+ -0.01950 * TEAM_FIELDING_E
;

If P_TARGET_WINS < 38 then P_TARGET_WINS = 38;
If P_TARGET_WINS > 114 then P_TARGET_WINS = 114;

Keep INDEX;
Keep P_TARGET_WINS;

run;

proc print data=SCOREFILE(obs=5); run;
